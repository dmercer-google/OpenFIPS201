new Packages.org.eclipse.ease.modules.EnvironmentModule().loadModule("/System/Environment", false);

loadModule("Communicator");
var sd = getCommandSetByName("Open FIPS 201");
sd.connect()
sd.selectByAID("a000000308000010000100", false)
sd.openSC();

print("ADD DATA OBJECT - 5FC107 - Card Capability Container")
var res = sd.send("00 DB 3F 00 0E 30 0C 8A 01 01 8B 01 07 8C 01 7F 8D 01 00")
res.checkOK()

print("ADD DATA OBJECT - 5FC102 - Cardholder Unique Identifier")
res = sd.send("00 DB 3F 00 0E 30 0C 8A 01 01 8B 01 02 8C 01 7F 8D 01 7F")
res.checkOK()

print("ADD DATA OBJECT - 5FC105 - X509 Certificate for PIV Authentication")
res = sd.send("00 DB 3F 00 0E 30 0C 8A 01 01 8B 01 05 8C 01 7F 8D 01 00")
res.checkOK()

print("ADD KEY - 9A - PIV Authentication Key (ECP256)")
res = sd.send("00 DB 3F 00 14 " +
		"30 12 " +
		"8A 01 02 " +  // Key
		"8B 01 9A " +  // ID 9A
		"8C 01 01 " +  // Contact = PIN
		"8D 01 00 " +  // Contactless = Never
		"8E 01 11 " +  // P256
		"8F 01 04"     // Role Auth Internal
		)
res.checkOK()

print("ADD DATA OBJECT - 5FC101 - X509 Certificate for Card Authentication")
res = sd.send("00 DB 3F 00 0E 30 0C 8A 01 01 8B 01 01 8C 01 7F 8D 01 7F")
res.checkOK()

print("ADD KEY - 9E - Card Authentication Key (P256)")
res = sd.send("00 DB " +
		"3F 00 " +  // Admin
		"14 " +  //14 bytes
		"30 12 " +  // Sequence 12 bytes
		"8A 01 02 " +  // Key
		"8B 01 9E " +  // ID = 9E
		"8C 01 7F " +  // Contact always
		"8D 01 7F " +  // Contactless always
		"8E 01 11 " +  // P256
		"8F 01 04"     // Role Auth Internal
		)
res.checkOK()

print("ADD DATA OBJECT - 5FC108 - Cardholder Facial Image")
res = sd.send("00 DB 3F 00 0E 30 0C 8A 01 01 8B 01 08 8C 01 01 8D 01 00")
res.checkOK()

print("ADD DATA OBJECT - 5FC103 - Cardholder Fingerprints")
res = sd.send("00 DB 3F 00 0E 30 0C 8A 01 01 8B 01 03 8C 01 01 8D 01 00")
res.checkOK()

print("ADD DATA OBJECT - 5FC106 - Security Object")
res = sd.send("00 DB 3F 00 0E 30 0C 8A 01 01 8B 01 06 8C 01 7F 8D 01 00")
res.checkOK()

/*   Optional but interesting
print(" ADD DATA OBJECT - 5FC109 - Printed Information")
res = sd.send("00 DB 3F 00 0E 30 0C 8A 01 01 8B 01 09 8C 01 01 8D 01 00")
res.checkOK()

print(" ADD DATA OBJECT - 7E - Discovery Object")
res = sd.send("00 DB 3F 00 0E 30 0C 8A 01 01 8B 01 7E 8C 01 7F 8D 01 7F")
res.checkOK()

print(" ADD DATA OBJECT - 5FC121 - Cardholder Iris Images")
res = sd.send("00 DB 3F 00 0E 30 0C 8A 01 01 8B 01 21 8C 01 01 8D 01 00")
res.checkOK()

print(" ADD DATA OBJECT - 7F61 - Biometric Information Templates Group Template")
res = sd.send("00 DB 3F 00 0E 30 0C 8A 01 01 8B 01 61 8C 01 7F 8D 01 7F")
res.checkOK()
*/

print ("PrePerso complete")



print("CHANGE REFERENCE DATA - PIN (80) to 123456")
res = sd.send("00 24 FF 80 08 31 32 33 34 35 36 FF FF")
res.checkOK()

print("CHANGE REFERENCE DATA - PUK (81) to 12345678")
res = sd.send("00 24 FF 81 08 31 32 33 34 35 36 37 38")
res.checkOK()

//-----------BEGIN Write Facial Image APDUs ------------
print("Tag  5FC108 - Facial Image part 1")
res = sd.send("10DB3FFF ED 5C03 5FC108 5382 15D6 BC8215D0030D000012670311001B05011412051A0330195A1412051A0330195A14200C020000005A00000220FE4E4953542043726561746F72000000000000D4E739DA739CED39CE739DA16858210842108515CCE739B7FA0000000046414300303130000000126700010000125900000000000000000001000000000000010001000100010200000000FFD8FFE000104A46494600010100000100010000FFDB004300100B0B0B0C0B100C0C10170F0D0F171B141010141B1F17171717171F1E171A1A1A1A171E1E23252725231E2F2F33332F2F404040404040404040404040404040FF")
res.checkOK()
print("Tag  5FC108 Facial Image part 2")
res = sd.send("10DB3FFF ED DB004301110F0F1113111512121514111411141A141616141A261A1A1C1A1A2630231E1E1E1E23302B2E2727272E2B35353030353540403F404040404040404040404040FFC000110800A200C803012200021101031101FFC4001B00010002030101000000000000000000000005060204070301FFC400491000010303020303050C060807010000000100020304051112210613312241511632546171071423334252628191A1A3D315658294B1E2242543539293A2D13444637283B2D2F0FFC40014010100000000000000000000000000000000FFC40014110100000000000000000000000000000000FFDA")
res.checkOK()
print("Tag  5FC108 Facial Image part 3")
res = sd.send("10DB3FFF ED 000C03010002110311003F00E80888808888088880888808BE1558A3E239E6E2F9ED6E70F78063A1830DF3AA210D7CA3563A804823D4105A117C5F50111101111011110111101111011110111101111011110111101117C41AD70AB650D0D45649BB29E37484779D20BB03A75E8A98EA392DBC336DBEBF7AB82A9B70AA783873D954E0D78FDA69603EC535C605D534F47658C9D774A8646FC0DC431112CAF1FF006E0297B850C7596EA8A0D9AC9A27443E8E5B86903D48365A4100B77690082166A1384AB1D5762A6320D3353834D337BDAF84E8C1F5E002A6D011110111101111011110111101111011110111")
res.checkOK()
print("Tag  5FC108 Facial Image part 4")
res = sd.send("10DB3FFF ED 101111011110162564BC6AA78E9A9E5A998E22818E91E7C1AC05C7EE082060FEB0E31A998F6A0B453B616039F8FA8EDB9CDFD8EC95622A0B83A9E46DA4D6CE315173964AD97FF29ECE3D5A4023DAA78FD882B964FE83C4778B59DA39DCDB8538F1E6F6663FE3C056355CBF7F42BED9EEC366BE4750541CF9CD9C13167D4D764AB10C65064888808888088880888808888088880888808B56E358DA0A296B248A499908D4E8E16EB908CF50D2474EA5415371BD2D5C7CEA4B5DCAA22CE9E6454E1EDC8EED4D90A0B3A2AFF95BFA92EDFBAFF3A795BFA92EDFBAFF003A0B022AFF0095BFA92EDFBAFF003A795BFA")
res.checkOK()
print("Tag  5FC108 Facial Image part 5")
res = sd.send("10DB3FFF ED 92EDFBAFF3A09E2A038C657BAD91DB617699EE93C74AD39E81CECBDC71DD8183ED43C5BFA96EDFBA7F3AF0A496A6F5C494F5F2515551D1DBA9DE621551989CEA898E876065DA872FEF4163862643132188698E368631BE0D68C05EAB10B2410FC57446BAC159137E318CE7478193AA23CCDBDB8C2DBB4D70B8DB696B463E1E26BDC06E0388ED0FA9D90B6CF4F11E0A9B67BF5B3871B5765B9CAE84D1D4C9EF5058E7669E43CC61F8369F9C4FD682E88AB838F385BD308F6C52FF00F0BEF979C2DE9A7FC99BF2D05891577CBCE16F4D3FE54DF96BEF977C2BE9DF8537E5A0B0A2AF7977C2BE9DF8337E5A7975C2")
res.checkOK()
print("Tag  5FC108 Facial Image part 6")
res = sd.send("10DB3FFF ED 87FE7BF066FCB416145E14D510D5411D4C0ED50CCD1246EC11A98F1A81C100F7AF740444404444044441895055DC3D232A5F73B14A286E0E76A99873EF6A9FA33463A1FA437DC9EA7227D627A2086B5F1132A6716EB8C46DF756839A693A48013DA85FD1E36FE38CE32A642D2BA5A282EF4E60AD8F581BC720DA48DC7E546EEE3B7FBA8715F76E1C3CBBB9757DA72D6C77263733423A62A58325C3E90FAF24E0059D178D3D443530B67A791B2C2F19648C21CD38DB6217B202C5C40193D3D6B19646451BA5908646C05CF71380D0D19249F05CA2FDC4573E26AF145441E291CED14F4ACEB26FB3E5C753B67C1B")
res.checkOK()
print("Tag  5FC108 Facial Image part 7")
res = sd.send("10DB3FFF ED F6921D21FC416263B43AE34A0E48239D1EC7D7DA385B54B594758D2FA39E2A863762E89ED7807DAC2573D83DCCEE8F89AE9EAA18A43B98C073F4FA89DB7FB941DC6D979E16B846E7BCC32E3541530B8E87818D41A703A670E047DC770ECEB07C8C8D85EF706B1A32E738E0003C4950FC2D7A37BB4B2A9ED0DA88DC629C0E9ADA3391EA21C0FDCA85C5D77AEBCDF1F6C85C4D3C337BDE0A7070D7CA0F2CBDDBE092EC807B87D683A29E23B007061B8D36A3D313308FF16AC2DD82A20A98C4B4F232689DE6C91B83DA7F69B95CEDBEE63733165D5700971E600F2DCF70D7A47F0505435D74E16BC3DBBB2585E1B5")
res.checkOK()
print("Tag  5FC108 Facial Image part 8")
res = sd.send("10DB3FFF ED 3067B12B46F83D7A83969FAD076758B8868249C01D49DB01611C8D9636CAC3A99200E63877870D8A82E37BA1B770FCFA1DA66ABFE8F191E0FF003FFD19DFC504BB2E76E91ED647550BDEE386B5B234B89F00015B21706619612C9E32585AECC720DBB6CC3B63E232176DB3DC5974B6D357B3613B03881F25FD1EDFD9702106F22220222202222022220222202C5C32082320EC41F059220ADD4586B2D733EBB869ED883897545B2438A79891FD9FF76EF0EEE9D00DF76CF7FA4BA1753E9752DC22039F4530D32B0FAB38D4DF58F5671952A7A28CBC5868AEC1AF935415917FC3D6C474CD111B8C387519EEFB30")
res.checkOK()
print("Tag  5FC108 Facial Image part 9")
res = sd.send("10DB3FFF ED 7741A9C6F52F83866B1CC716BA40C8F23C1EF6870FADB90AA7EE694AC92E95354E00BA9E1D2CC8E8E91DD4786CD23EB52F23EE37EE0AB81A8736A1F1BDFEF6A86B0B39F15339AEE66807CE76970D957FDCF2E30D1DE9D4F33835B591F2A327001943816039F1DC0F5E020E9171B9D15AA9BDF55D272A00E0DD7A5CEDDDD0618D7150753C59C13581ADAC9A2A90C24B44B4D249A4FAB545B295BF59997BB79A17CA61697B5FADA351ECF76090B9F7157074160A18AAA3A97CEE925116973034005AE767209F9A83A15A2ED69B944FFD13207C50901E191BA30D2EDC6CF6B7EE5CEF8CEC3596CBB4B71858E34750")
res.checkOK()
print("Tag  5FC108 Facial Image part 10")
res = sd.send("10DB3FFF ED F33327667E0E571D4E6B88F34EA3D9FBB7054DFB989C515C4E0BBB71EC3A9ECB96FD071FDB6E37286DEDA79236D43B962494B40D441D20B46AF38EC82B141EE897CA50D65488EB583192F1A2420776A6607DAD2AC36AE25E16BE5635959430C1719C86874F1C72091D8D2D689B4E49C0C0D58F00A5ABB83B872BB2E928DB0C8479F0662233DFA59D8FB415CDB8A6C9158EEA68E194CB1398D9585D8D6D0E2E1A5D8C6FD941D89AD6B1A18C01AD6801AD000000D80C2E7DC605F7EE20659E9EA2189D46D0D632771609679B0E7063835C338D23071BE4056BB75D797C314F75AD2ECB2984B29779CF2D6F5F6BF1")
res.checkOK()
print("Tag  5FC108 Facial Image part 11")
res = sd.send("10DB3FFF ED B7B57266736E973CCF2359255CA5D34CF3863359D4F7BB2766B46E82F953C0B2CDC35496E89D136E50486692576430997E31B96877706F77C90BD781E436EA8ACE1D9EA62A99A1F876181CE7B1B93A258F53DADDDA749C0F13DF95E3E5FD99D506D863945AF97C8F7E6A7733A68D5A7CFC63BF3ABBF1954FB6D53B87F8862975B646534BA64923ED36485DD97399E21CC396FD483B30F52C960D7020104107704782CD01111011110111101111011110143F14D79A0B155CEC244CE672A1D3D75CBF060B7D6339FA94B1E8AB979C5C388ED569033152975C6A40EEE57621FF005EC7DA825ED1402DD6CA5A16E0")
res.checkOK()
print("Tag  5FC108 Facial Image part 12")
res = sd.send("10DB3FFF ED 72236B5F8E85F8CBCFD6E39543E27E03AB8677D6D9A3E7D33C973A99BE7C79DCE81F29BE18DFBBD6BA47F15920E45E55718D0B5B4D2D44B196F6409E269933EB74B1971FAD797E8EE2AE22A86C92C551504F9B2CC0B22603D7497696347A82EC4B52BEE3456DA73555B336085A71A9D9DDDE0D0325C76E81045709F0E3EC14724734C26A8A8735D2E9D98DC0C00DCE1C7DBF70553E2BE0BAF82BA4B85AA2754534EE323A28866489EE3B80C1D5B9DC63A74EEC9E8B4B530D542CA8A7904B0C83531ED390415EE8391378B78BE9F4D31A9903DA30D1242C74840F12F8CB9DED2BEDBB867883882BF9F56C9638E4")
res.checkOK()
print("Tag  5FC108 Facial Image part 13")
res = sd.send("10DB3FFF ED 7033D5D402091F435F9C703031B776CBAE220A871AC357158A9ACF69A59A68DE5AC708637481B0C20696B8B41DCBB4FD8552687843886B66E5368E4806DAA5A869898D07BF2F1BFECE57654414BB47B9CDBA98B65BA486B261BF29B96420FF00ECEDFD9EB0A278E786258EBE1AAB4D1B9D04ECD2F8A9A225AC7B36CE98DB801CD231EC2BA522080E0D9EB24B1410D6C32C1514BF0244AC3197318072CB4380DB4103EA53E8880888808888088880888808888312ABBC358AFB9DDAF9B3992CC29695C0E7E069C60B9A7E6BCEEA43892E3FA32C95956D25B23632D888EA2493B0C23D84E56560B7FE8CB3D25111")
res.checkOK()
print("Tag  5FC108 Facial Image part 14")
res = sd.send("10DB3FFF ED A5F1443983FEA3BB727FA9C50492C4AC647B238DD2484318C05CE738E1AD0372492AB92DDAE37E91F4BC3F9828C7667BB48DECFAC5330E35BB6C67BBD5B141BB76E208A8E61414713ABEEB27C5D1C7F241F9533BA31BBF7FF0DD78D070F492D536E97E9456DC012E86200FBDA987CD8987BC63CE3EAEFDCEFDA6CD436989CCA469324A75CD5121D734CEF9D23CF5EBECFB548A0ACCF6CACE1F9E4AFB1C467A099DAEB2D4DEE3DF2D30EE77D1EFE83BB1356DB9515D295957452092176C7B8B5DDED70EE705B45405C2CD574956FBC5830CAB90E6B28DC74C3563AEFDCD937D9DE3D7A9C8585146D9EF3497785C")
res.checkOK()
print("Tag  5FC108 Facial Image part 15")
res = sd.send("10DB3FFF ED F8731CF11D1554D20D32C320D8B5EDDBC0E0FF00B1C4920C4AC1D2461ED8DCE0D7BF3A1A4E1CEC6E70166553AF74F79ABBACB74A4A39246DA4C62932F7C4642C3CCA8D1118CF30480E8D88E9B6505AC54D3198C025619B3F17A86AC8DFCDEBD3759C6F8E46EA8DC1CDC9196904641C1E8AA94D619AE373AAAD91ADA589B5D1D4C6F9299CDAA7B5AD8DE0325796E96E763B1C1056F70DD53A087F474F4B531CCE9EA1DADF048D8B4BA47C8D3CD2DD3B8E8826C555319B922561981DE3D435F4CF9B9F05EA06154D9C3D3D75DEB6A256C74F1B2BA39992BA9CFBE1E236C6EF829DCE6E1848EE07BD7986DF451D3C")
res.checkOK()
print("Tag  5FC108 Facial Image part 16")
res = sd.send("10DB3FFF ED B5135788AAE79856F25999E08E374A2010B044E786BF62E383B6318082E48B9F5C2E7C41050892B66AAA7A98E8C4B13616340D4F96466AAB1A5DA098C34F76F9C76B652551FA65B1D7CEE7571D55EEA68218B2D6B29BB2F13374C1349A7A8CB01F577A0B7A2A109B8B24A26CAE7D6B2A20A33235AD84832D432A9F1B1AF6F28E4F2B04B7BC6E559EC8CAD89D5B4F5524D3321A82DA79A7003DF198E376CE6B5AD70D45C3EEEE412C8888088880B12B2589CF720AE7107F585EAD3651BC7CC35D563A8E5C1F161C3E6BDD90A56EB78A1B4C027AC7E359C45133B524AE1F263677FF000F1553A7BCD44DC4D7396D")
res.checkOK()
print("Tag  5FC108 Facial Image part 17")
res = sd.send("10DB3FFF ED 94E6B2E0E228E943BB3053C30FC6492BC7C973C65A01C9DFA6429FB4F0EB69A7172B94A6E17770C3AA5FE6C59DF442CE8D1BE33EDC633841A8CB5DCF885C2A2F81D476DC0315A98E21CFDF50754B860FECF77A8839B2451C70B1B144C6C71B069646D01AD681B6001DCB21D5648088880B13D1648820EED637CD502EB6A90525DD8DC737FB39DBFDDCEDF9436D8F51B780C7AD96F91DC5D2D25446692E94BB5551BFCE1D3B6C3F299BF51E23C4132C5455E6C915CF45444F34B72A7DE9AB23F3D9F45DF39BBEE3DA82554154F1149155D450C54866A98EA21A581A240D123A68F9E5EE25874358D07E72FB68BD")
res.checkOK()
print("Tag  5FC108 Facial Image part 18")
res = sd.send("10DB3FFF ED 4AFA8368BB30535DE36E401F1752CFEF603DFD371DDBF81032AAE1D8E79EA2A99512415334F154C32B034F2A4863E48D9D9D40B7390502A6F957476C7D555D03A3ACE70A78690481C277BDC1ACE5481BD1C0E776E762BC66E2C8582CEF641AE1BBF9D207FC41D51B3B4349CE1D260F459BB861B5220171ADA8AC6C523E79039C630F95ED0D696F2F4F2DACDF486F792BC1FC1946EA6349CF905337DF029E3233CA152637E0389C9D0F8F233E3BA0D9B37124575A6ADAB311A7A7A37B807171717C6D6F335E034632DDF1BACED977B8D73E0925B73A1A2AB8CCB0D4095AF2D6F567359A5BA75B771827F8E3D2DB")
res.checkOK()
print("Tag  5FC108 Facial Image part 19")
res = sd.send("10DB3FFF ED 62A5B7C1514ED26482A431AE63863B31C4CA7C6DE219BFB56A47C3552C84D31BAD43A9E385F4F49161AD113246F2FB7CBD3CC2D68ECEAE9D420D237BB65CA9ABAE5516C8E49ADAD32D299834BA6A7D4E11CAC7399D904B4F8E0AFAEE357322AB79A58A5752C31CE0D3D489E2709256C258E9591F61FDACE3072B65FC196D635CCA373E98494F252CDDA74BAE39305BF1AE3A74B867B385E959C294B3B2AA2826752C15B1C6DA88630DD06489CD7B66683E6BB0DC1EE3DFBA0C2A789E7A28AB05750F26AA91B148D8DB2F32392295FCB12730463486BB3AB2DFB54859EE6FB953C933E38E3D121635D0CCDA889E")
res.checkOK()
print("Tag  5FC108 Facial Image part 20")
res = sd.send("10DB3FFF ED 001DA6C8CC78F42015AA387A6773E796E550EB84A236B2B00646636C44BDAD11C6D6B4B4977681EAB66CF686DAD9313299E7A97F327934362697001A34C713435BB0FACEE504922220FA88880B12B2441A9416EA2B744E868A0653C65C5C5AC18C93DE4F7FFF008772DB4440444404444044440589E8B2441A173B45BAED1361B840D9D8C3A99925AE693E0E616B828DF217857D07F1A6FCC5614415FF00213853D07F1A6FCC4F213853D07F1A6FCC5604415FF213853D07F1A6FCC4F213853D07F1A6FCC5604415FF00213853D07F1A6FCC4F213853D07F1A6FCC5604415FF213853D07F1A6FCC4F213853D07")
res.checkOK()
print("Tag  5FC108 Facial Image part 21")
res = sd.send("10DB3FFF ED F1A6FCC560441156CE1AB2DA2A1D536FA6E4CCF618DCEE648FCB090E23123DC3AB4229544044440444404444044440444404444044440444404444044440444404444044441FFFD93082030D06092A864886F70D010702A08202FE308202FA020103310F300D06096086480165030402010500300A06086086480165030602318202D6308202D202010130733065310B300906035504061302555331183016060355040A130F552E532E20476F7665726E6D656E7431183016060355040B130F4943414D205465737420436172647331223020060355040313194943414D20546573742043617264205369676E")
res.checkOK()
print("Tag  5FC108 Facial Image part 22")
res = sd.send("10DB3FFF ED 696E67204341020A5853CCE2521801412008300D06096086480165030402010500A0820136301706092A864886F70D010903310A06086086480165030602301C06062B060101100431120410BE127EA0D180124DE044000F202B235A301C06092A864886F70D010905310F170D3138303532363139343832355A302706086086480165030606311B0419D4E739DA739CED39CE739DA16858210842108515CCE739B7FA302F06092A864886F70D01090431220420E66EBD6D499C80C197792C5501542B2A3494EF6AA90F622BDB1F030E3AD1BDCC3081840608608648016503060531783076310B300906035504")
res.checkOK()
print("Tag  5FC108 Facial Image part 23")
res = sd.send("10DB3FFF ED 061302555331183016060355040A130F552E532E20476F7665726E6D656E7431183016060355040B130F4943414D2054657374204361726473313330310603550403132A4943414D205465737420436172642047656E312D32205049562D4920436F6E74656E74205369676E6572300B06092A864886F70D01010104820100A252E68EEE89E5119BC0C5CCC1FC16BD7D02A4F6E4CFE0791B18D00205EB107BB6EAE2A30DF2D356383B9C77A293B666E1A7AA1E051EF72368996535DAB798C2A8144FA8E7694F731601EF3D3B56F995A8541C3B9708CE53A0A445115EBD6609C3704B949BDCD8E9A22F810D9A62")
res.checkOK()
print("Tag  5FC108 Facial Image part 24")
res = sd.send("00DB3FFF 94 96DF5C2A5BDB8F0A950E839AE59E7F046F373C2C28DA91BC1D6CF43FE4667F11DE88327CABDFA4D2F6D0CA5A2994D6F102A1BB95A8577D7953C7DE421CDE76FF60870D10D617249CB4EA6EC60B821320D7E260936A2BA4BCCCB60529990C67CD5FDC822ED2E32537F1F11BE7C50E5E4BF64730F555E7FBDAAC4EA8F0F86AB85F291B48EF12AFD5D494B5C21AE6F60EFB1A4EFE00")
res.checkOK()
//-----------END Write Facial Image APDUs ------------


//-----------BEGIN Write Fingerprints APDUs ------------
print()
print("Tag  5FC103 - Fingerprints part 1")
res = sd.send("10DB3FFF ED 5C03 5FC103 5382 05B7 BC8205B1030D000002480311001B02011412051A0330265A1412051A0330265A14200C020000005A00000880FE4E4953542043726561746F72000000000000D4E739DA739CED39CE739DA16858210842108515CCE739B7FA00000000464D5200203230000248000100018001020001E000C500C5020007003C294135005104004121007A040040C2007B6D00413C00805B00412D0090010080D100A50B00416B00B04D00412100BF620040EB00C6100040FB00DF0B00413300E5AD0040A800E87300815700EB9800810000F10700811600F26200814C00F34C00412000F76800410200F9")
res.checkOK()
print("Tag  5FC103 Fingerprints part 2")
res = sd.send("10DB3FFF ED 6B00814300FD560081680109A300817C010F490080B8012F1D00409E01491D0041250151820080A901536600809C01546B0080C0015B1A00413B01619C00811201692200411401761A0041270179AC0080B3017F1200813B01825300816501864C0080E10190110080E0019E0B00416501A5510040C301B0080040F601BB040080EC01C70100413801C85800000002103C3241310015A40080EF001FAD00413C00394A0041560039470081010040AD008117004D5100414B004D9C00415900644400814F00709E0040BA0081060080AE008A040080B100975A00416A009A4100411900A14C00814100A59D0040")
res.checkOK()
print("Tag  5FC103 Fingerprints part 3")
res = sd.send("10DB3FFF ED A300AD020040B500B96800414600BA420040B200C10B0040E300C7010040C900C90B0040A700D306008103010D9B0080FA011B3F008130011F79004111012B1D00811D012F1A00414101313600812D01350F00813F013A5900811E013F0900814301465A008132014B000040FF014F0F0041610152A100814D0157A800811D01596200417E015A44004166015D4C004169015E9B0080CB01610F00810001630A00815F01674D00812B016E5F0080C001790E00817F017A4500817001814D00813501876200811801980500812A019B5E0000003082030D06092A864886F70D010702A08202FE308202FA020103")
res.checkOK()
print("Tag  5FC103 Fingerprints part 4")
res = sd.send("10DB3FFF ED 310F300D06096086480165030402010500300A06086086480165030602318202D6308202D202010130733065310B300906035504061302555331183016060355040A130F552E532E20476F7665726E6D656E7431183016060355040B130F4943414D205465737420436172647331223020060355040313194943414D20546573742043617264205369676E696E67204341020A5853CCE2521801412008300D06096086480165030402010500A0820136301706092A864886F70D010903310A06086086480165030602301C06062B060101100431120410BE127EA0D180124DE044000F202B235A301C06092A86")
res.checkOK()
print("Tag  5FC103 Fingerprints part 5")
res = sd.send("10DB3FFF ED 4886F70D010905310F170D3138303532363139343833385A302706086086480165030606311B0419D4E739DA739CED39CE739DA16858210842108515CCE739B7FA302F06092A864886F70D0109043122042099BE85A604C6887573E697BF3598CB68DAEADED57EB7C799BB443036FDE432A83081840608608648016503060531783076310B300906035504061302555331183016060355040A130F552E532E20476F7665726E6D656E7431183016060355040B130F4943414D2054657374204361726473313330310603550403132A4943414D205465737420436172642047656E312D32205049562D4920436F")
res.checkOK()
print("Tag  5FC103 Fingerprints part 6")
res = sd.send("10DB3FFF ED 6E74656E74205369676E6572300B06092A864886F70D010101048201004DF3CA5E4D6D86392A7D566C56E73619293931329AC953C3FE2A43C0E2EB4C686C848EB09FBC933FFBA89070748CDDEA3E9F3915506F76DE45B6F07E25DADADC6BF8A26B23AB4E11233C8EE99A4A98F0CD74467A2C97870BB32BB4EF643B08AACD9E54D8F5964A99BE96FE19DA422D8C6902945B7DC18F159F74A617012707BDDA1E42D821616A5A66B8FAF5C58559E059D50ED688BDEC3B3DF6E97ADA15259B8B1B002A0457BB3D9FEEF7691BDE5A2B3E5D0F0F0D2F9178CA198CB5F0A8D26ADEE25B6E9DF625BBD96996BAA576DBAE")
res.checkOK()
print("Tag  5FC103 Fingerprints part 7")
res = sd.send("00DB3FFF 32 6B5832A0517B06C325244D95AEFE57CE53AC5110914AEEC777380F4396589E70945FFD0948D908C12476904893407560FE00")
res.checkOK()
//-----------END Write Fingerprints APDUs ------------

/*
//-----------BEGIN CERTIFICATE 9A--------------
print("PUT DATA - 5FC105 - X.509 Certificate 9A (Part 1 of 4)")
res = sd.send("10 DB 3F FF" +
"EF" +
"5C 03" +
"5F C1 05" +
"53" +
"82 03 81" +
"70" +
"82 03 78" +
"3082037430820319a003020102020105300a06082a8648ce3d0403023055310b3009060355040613025553310f300d060355040a1306476f6f676c65310f300d060355040b1306506879536563312430220603550403131b476f6f676c6520546573742043617264205369676e696e67204341301e170d3138303532363030303030305a170d3332313132393233353935395a3066310b3009060355040613025553310f300d060355040a1306476f6f676c65310f300d060355040b1306506879536563313530330603550403132c476f6f676c6520546573742043617264204765")
res.checkOK()

print("PUT DATA - 5FC105 - X.509 Certificate 9A (Part 2 of 4)")
res = sd.send("10 DB 3F FF" +
"EF" +
"6e312d32205049562d492041757468656e7469636174696f6e3059301306072a8648ce3d020106082a8648ce3d03010703420004bf0af1c1fa28ac00e3d12842db9964d3ba1a53e28b697fce0fe3fdaec5e551f2be8fa27b9ae9b81eb8d50e48e41c235f30a7b623f21fbb6e1d4aa81b5b3db3c2a38201c7308201c3301d0603551d0e0416041469b76b3dfb5c1663740c0610caa64660739f16a9301f0603551d230418301680143f079ee5854cc76a02da70fe202e362b6c5b42f8300e0603551d0f0101ff040403020780301f0603551d250418301606082b06010505070302060a2b0601040182371402023038")
res.checkOK()

print("PUT DATA - 5FC105 - X.509 Certificate 9A (Part 3 of 4)")
res = sd.send("10 DB 3F FF" +
"EF" +
"0603551d110431302f862d75726e3a757569643a62653132376561302d643138302d313234642d653034342d30303066323032623233356130560603551d1f044f304d304ba049a0478645687474703a2f2f687474702e61706c2d746573742e636974652e66706b692d6c61622e676f762f63726c732f4943414d54657374436172645369676e696e6743412e63726c30180603551d200411300f300d060b60864801650302013081783081a306082b06010505070101048196308193305d06082b060105050730028651687474703a2f2f687474702e61706c2d746573742e636974652e66706b692d6c61622e67")

print("PUT DATA - 5FC105 - X.509 Certificate 9A (Part 4 of 4)")
res = sd.send("00 DB 3F FF" +
"BD" +
"6f762f6169612f6365727473497373756564546f4943414d54657374436172645369676e696e6743412e703763303206082b060105050730018626687474703a2f2f6f6373702e61706c2d746573742e636974652e66706b692d6c61622e676f76300a06082a8648ce3d0403020349003046022100cab7e92bedc88c515078270b4a9eef6448c8df1083d5ebdd437443b9daaf4caa022100ba36ee4212680c1c640a31cac907907998a091a8150d48e86e69ca13b176f2d1710100FE00")

print("9A cert installed")
//-----------END CERTIFICATE 9A--------------

print("CHANGE REFERENCE DATA - Key = 9A, Mechanism = 11 (ECC Point)")
res = sd.send(
		"00 24 " + // Change Ref Data
		"11 " +    // P256
		"9A " +    // Key ID 9A
		"45 " +    // APDU Len
		"30 43 " + // Sequence + :Len
		"86 " +    // EC Point
		"41 " +    // 65 Bytes
		"04BF0AF1C1FA28AC00E3D12842DB9964D3BA1A53E28B697FCE0FE3FDAEC5E551F2BE8FA27B9AE9B81EB8D50E48E41C235F30A7B623F21FBB6E1D4AA81B5B3DB3C2")
res.checkOK()

print("CHANGE REFERENCE DATA - Key = 9A, Mechanism = 11 (ECC Secret)")
res = sd.send(
		"00 24 " + // Change Ref Data
		"11 " +    // P256
		"9A " +    // Key ID 9A
		"24 " +    // APDU Len
		"30 22 " + // Sequence + :Len
		"87 " +    // EC Point
		"20 " +    // 32 Bytes
		"6CBD2B88E189E2BB5D6BAC65CBD50E91A782474BE20F39557602D3DA3D981003")
res.checkOK()
*/
//-----------BEGIN CERTIFICATE 9E--------------
print("PUT DATA - 5FC101 - X.509 Certificate 9E (Part 1 of 4)")
res = sd.send("10 DB 3F FF" +
"EF" +
"5C 03" +
"5F C1 01" +
"53" +
"82 03 56" +
"70" +
"82 03 4D" +
"30820349308202f0a003020102020104300a06082a8648ce3d0403023055310b3009060355040613025553310f300d060355040a1306476f6f676c65310f300d060355040b1306506879536563312430220603550403131b476f6f676c6520546573742043617264205369676e696e67204341301e170d3138303532363030303030305a170d3332313133303233353935395a305e310b3009060355040613025553310f300d060355040a1306476f6f676c65310f300d060355040b1306506879536563312d302b0603550405132462653132376561302d643138302d313234642d")
res.checkOK()

print("PUT DATA - 5FC101 - X.509 Certificate 9E (Part 2 of 4)")
res = sd.send("10 DB 3F FF" +
"EF" +
"653034342d3030306632303262323335613059301306072a8648ce3d020106082a8648ce3d03010703420004487cb4cabecf15141e89600a883c7db670e77bca84eebb0357313355192e0216df65a96e132ba3f2b895d9e7a0db38e38d4859b0994e5ae3d442d89608f4b784a38201a6308201a2301d0603551d0e041604148d7cbe7388c82df6ac5f9ccc947a7c89060cb9f7301f0603551d230418301680143f079ee5854cc76a02da70fe202e362b6c5b42f8300e0603551d0f0101ff04040302078030380603551d110431302f862d75726e3a757569643a62653132376561302d643138302d313234642d6530")
res.checkOK()

print("PUT DATA - 5FC101 - X.509 Certificate 9E (Part 3 of 4)")
res = sd.send("10 DB 3F FF" +
"EF" +
"34342d30303066323032623233356130560603551d1f044f304d304ba049a0478645687474703a2f2f687474702e61706c2d746573742e636974652e66706b692d6c61622e676f762f63726c732f4943414d54657374436172645369676e696e6743412e63726c30180603551d200411300f300d060b60864801650302013081793081a306082b06010505070101048196308193305d06082b060105050730028651687474703a2f2f687474702e61706c2d746573742e636974652e66706b692d6c61622e676f762f6169612f6365727473497373756564546f4943414d54657374436172645369676e696e674341")

res.checkOK()

print("PUT DATA - 5FC101 - X.509 Certificate 9E (Part 4 of 4)")
res = sd.send("00 DB 3F FF" +
"92" +
"2e703763303206082b060105050730018626687474703a2f2f6f6373702e61706c2d746573742e636974652e66706b692d6c61622e676f76300a06082a8648ce3d040302034700304402204256220e81f9b1f415880d27d8392b3f5012d0499c4a0fd69333ab68ae3cfd33022034ec0e263d25a17eef4120916eccf5502438277068a0b32f5c506891861de5cc710100FE00")
res.checkOK()

print("9E Cert installed")

print("CHANGE REFERENCE DATA - Key = 9E, Mechanism = 11 (ECC Point)")
res = sd.send(
		"00 24 " + // Change Ref Data
		"11 " +    // P256
		"9E " +    // Key ID 9E
		"45 " +    // APDU Len
		"30 43 " + // Sequence + :Len
		"86 " +    // EC Point
		"41 " +    // 65 Bytes
		"04487CB4CABECF15141E89600A883C7DB670E77BCA84EEBB0357313355192E0216DF65A96E132BA3F2B895D9E7A0DB38E38D4859B0994E5AE3D442D89608F4B784")
res.checkOK()


print("CHANGE REFERENCE DATA - Key = 9E, Mechanism = 11 (ECC Secret)")
res = sd.send(
		"00 24 " + // Change Ref Data
		"11 " +    // P256
		"9E " +    // Key ID 9E
		"24 " +    // APDU Len
		"30 22 " + // Sequence + :Len
		"87 " +    // EC Point
		"20 " +    // 32 Bytes
		"69934B97010191390D8BB0A1EA319D88579DE2C69363880FF8098E721484EF28")
res.checkOK()

//-----------BEGIN Write CHUID APDUs ------------
print("Tag  5FC102 - CHUID part 1")
res = sd.send("10DB3FFF ED 5C03 5FC102 5382 055D 3019D4E739DA739CED39CE739DA1685821084210CD15CCE739B7E8320431323334341053489BCF9FF64534A6FB48C5FD24743A350832303233303331333E8205043082050006092A864886F70D010702A08204F1308204ED020103310F300D06096086480165030402010500300A06086086480165030601A082031C30820318308202BEA003020102020103300A06082A8648CE3D0403023055310B3009060355040613025553310F300D060355040A1306476F6F676C65310F300D060355040B1306506879536563312430220603550403131B476F6F676C6520546573742043617264")
res.checkOK()
print("Tag  5FC102 CHUID part 2")
res = sd.send("10DB3FFF ED 205369676E696E67204341301E170D3138303532363030303030305A170D3332313233303233353935395A3066310B3009060355040613025553310F300D060355040A1306476F6F676C65310F300D060355040B1306506879536563313530330603550403132C476F6F676C65205465737420436172642047656E312D32205049562D4920436F6E74656E74205369676E65723059301306072A8648CE3D020106082A8648CE3D0301070342000482E251A4D1ED25590DDE611E6A564793572CDCC7393A26CAC7F607D8A79A786A15B3B7C452352136C2101A4C9B9FDE292F2A44AF956190455B1AAC7A25045B")
res.checkOK()
print("Tag  5FC102 CHUID part 3")
res = sd.send("10DB3FFF ED C8A382016C30820168301D0603551D0E041604140EDE95DDC054AFF149CC2293C65F3BE17EE4D1F0301F0603551D230418301680143F079EE5854CC76A02DA70FE202E362B6C5B42F8300E0603551D0F0101FF04040302078030560603551D1F044F304D304BA049A0478645687474703A2F2F687474702E61706C2D746573742E636974652E66706B692D6C61622E676F762F63726C732F4943414D54657374436172645369676E696E6743412E63726C30180603551D200411300F300D060B608648016503020130817C3081A306082B06010505070101048196308193305D06082B06010505073002865168")
res.checkOK()
print("Tag  5FC102 CHUID part 4")
res = sd.send("10DB3FFF ED 7474703A2F2F687474702E61706C2D746573742E636974652E66706B692D6C61622E676F762F6169612F6365727473497373756564546F4943414D54657374436172645369676E696E6743412E703763303206082B060105050730018626687474703A2F2F6F6373702E61706C2D746573742E636974652E66706B692D6C61622E676F76300A06082A8648CE3D04030203480030450220653D060C837A7860449C711FD4844E34B4240C104B78F4174736D5669CE6123A022100E2E4840F0244F1E760A423DD7E89E478E110C915F2EA7C1DBD470BD6AFD9AEB3318201A9308201A5020101305A3055310B3009")
res.checkOK()
print("Tag  5FC102 CHUID part 5")
res = sd.send("10DB3FFF ED 060355040613025553310F300D060355040A1306476F6F676C65310F300D060355040B1306506879536563312430220603550403131B476F6F676C6520546573742043617264205369676E696E67204341020103300D06096086480165030402010500A081DE301706092A864886F70D010903310A06086086480165030601301C06092A864886F70D010905310F170D3230303631363230343630315A302F06092A864886F70D0109043122042084F974B60B34353CA205F187701F88B00277C562574A71E7C863C05331AFA53C30740608608648016503060531683066310B3009060355040613025553310F")
res.checkOK()
print("Tag  5FC102 CHUID part 6")
res = sd.send("00DB3FFF C5 300D060355040A1306476F6F676C65310F300D060355040B1306506879536563313530330603550403132C476F6F676C65205465737420436172642047656E312D32205049562D4920436F6E74656E74205369676E6572300B06072A8648CE3D0201050004473045022045FEF61755DAEA6BA21024C594845F37A64AE3B898FB6A3C8F68F9B157BB3E17022100BB58E235F1DF2D835A65B444CD5E65FB82D8B45E6838A0D7E84C708ED96CA8CBEE02F9053610DB17539147494A32977D7A3843775E8AFE00")
res.checkOK()
//-----------END Write CHUID APDUs ------------

//-----------BEGIN Write Security Object APDUs ------------
print("Tag: 5FC106 - Security Object part 1")
res = sd.send("10DB3FFF ED 5C03 5FC106 5382 024C BA04015FC109BB8202423082023E06092A864886F70D010702A082022F3082022B020103310F300D06096086480165030402010500300A06086086480165030601318202073082020302010130818E308188310B3009060355040613025553310B30090603550408130257413111300F060355040713084B69726B6C616E64310F300D060355040A1306476F6F676C65311A3018060355040B1311506879736963616C205365637572697479312C302A06035504031323476F6F676C6520546573742043617264205049562D49205369676E696E672043412031020103300D0609608648")
res.checkOK()
print("Tag: 5FC106 Security Object part 2")
res = sd.send("10DB3FFF ED 0165030402010500A0820105301706092A864886F70D010903310A06086086480165030601301C06092A864886F70D010905310F170D3230303630313232323732385A302F06092A864886F70D01090431220420EF779619B6BE5A73420243D5BB37A668B80CF06A100AAF45C4A2EF279F6BB02430819A0608608648016503060531818D30818A310B3009060355040613025553310B30090603550408130257413111300F060355040713084B69726B6C616E64310F300D060355040A1306476F6F676C65311A3018060355040B1311506879736963616C205365637572697479312E302C0603550403132547")
res.checkOK()
print("Tag: 5FC106 Security Object part 3")
res = sd.send("00DB3FFF 7B 6F6F676C6520546573742043617264205049562D4920436F6E74656E74205369676E6572300B06072A8648CE3D0201050004483046022100F7904386F6FD949B15D2D9FF812ED990A30475800D765E260D0159BB475FD15B0221008D6098F43301D8E144BA3E0FC042E16A4D24E46A4DDB311A74D9F862CA4E913E")
res.checkOK()
//-----------END Write Security Object APDUs ------------


print("Personalization complete")






