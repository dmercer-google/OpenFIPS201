new Packages.org.eclipse.ease.modules.EnvironmentModule().loadModule("/System/Environment", false);

loadModule("Communicator");
var sd = getCommandSetByName("Open FIPS 201");
sd.connect()
sd.selectByAID("a000000308000010000100", false)
sd.openSC();
var res = sd.send("00 48 00 00")
print("SecurityLevel = " + res)

//-----------BEGIN Write Security Object APDUs ------------
print("Tag: 5FC106 - Security Object part 1")
res = sd.send("10DB3FFF ED 5C03 5FC106 5382 024C BA04015FC109BB8202423082023E06092A864886F70D010702A082022F3082022B020103310F300D06096086480165030402010500300A06086086480165030601318202073082020302010130818E308188310B3009060355040613025553310B30090603550408130257413111300F060355040713084B69726B6C616E64310F300D060355040A1306476F6F676C65311A3018060355040B1311506879736963616C205365637572697479312C302A06035504031323476F6F676C6520546573742043617264205049562D49205369676E696E672043412031020103300D0609608648")
res.checkOK()
print("Tag: 5FC106 Security Object part 2")
res = sd.send("10DB3FFF ED 0165030402010500A0820105301706092A864886F70D010903310A06086086480165030601301C06092A864886F70D010905310F170D3230303630313232323732385A302F06092A864886F70D01090431220420EF779619B6BE5A73420243D5BB37A668B80CF06A100AAF45C4A2EF279F6BB02430819A0608608648016503060531818D30818A310B3009060355040613025553310B30090603550408130257413111300F060355040713084B69726B6C616E64310F300D060355040A1306476F6F676C65311A3018060355040B1311506879736963616C205365637572697479312E302C0603550403132547")
res.checkOK()
print("Tag: 5FC106 Security Object part 3")
res = sd.send("00DB3FFF 7B 6F6F676C6520546573742043617264205049562D4920436F6E74656E74205369676E6572300B06072A8648CE3D0201050004483046022100F7904386F6FD949B15D2D9FF812ED990A30475800D765E260D0159BB475FD15B0221008D6098F43301D8E144BA3E0FC042E16A4D24E46A4DDB311A74D9F862CA4E913E")
res.checkOK()
//-----------END Write Security Object APDUs ------------

print("Security Object written")

