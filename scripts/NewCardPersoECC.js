new Packages.org.eclipse.ease.modules.EnvironmentModule().loadModule("/System/Environment", false);

loadModule("Communicator");

importPackage(com.infineon.tools.apdu);
importPackage(com.infineon.tools.apdu.secora);
importPackage(com.infineon.tools.apdu.gp);

var sd = getCommandSetByName("Open FIPS 201");
sd.connect()
sd.selectByAID("a000000308000010000100", false)
sd.openSC();
var res = sd.send("00 48 00 00")
print("SecurityLevel = " + res)

print("Generating ECC P256 9A Key")
res = sd.send("00 47 00 9A 05 AC 03 80 01 11")
res.checkOK()
print(res)

print("Generating ECC P256 9E Key")
res = sd.send("00 47 00 9E 05 AC 03 80 01 11")
res.checkOK()
print(res)

print("Generating ECC P384 9A Key")
res = sd.send("00 47 00 9A 05 AC 03 80 01 14")
res.checkOK()
print(res)

print("Generating ECC P384 9E Key")
res = sd.send("00 47 00 9E 05 AC 03 80 01 14")
res.checkOK()
print(res)

print("CHANGE REFERENCE DATA - Key = 9A, Mechanism = 11 (ECC Point)")
res = sd.send(
		"00 24 " + // Change Ref Data
		"11 " +    // P256
		"9A " +    // Key ID 9A
		"45 " +    // APDU Len
		"30 43 " + // Sequence + :Len
		"86 " +    // EC Point
		"41 " +    // 65 Bytes
		"04 01 F4 8C 5F ED 23 C7 5D FF F4 3A F8 49 2B F6 6A 18 37 8B FB 06 E9 2D 3E 9A AE 96 0C B0 AE 40 87 BC 3B 38 D2 82 EF 06 32 EB B9 9C 7A 65 94 26 5E E1 93 CF 96 4F 5B CE ED A0 EB AD E8 36 D1 F5 14")
res.checkOK()

print("CHANGE REFERENCE DATA - Key = 9A, Mechanism = 11 (ECC Secret)")
res = sd.send(
		"00 24 " + // Change Ref Data
		"11 " +    // P256
		"9A " +    // Key ID 9A
		"24 " +    // APDU Len
		"30 22 " + // Sequence + :Len
		"87 " +    // EC Point
		"20 " +    // 32 Bytes
		"AF C6 76 48 A4 15 84 F4 4D F5 90 AB 82 6B F9 DE 6F 49 9C 85 4A F9 66 DF BE 7B 7F 2B 2C C2 29 0F")
res.checkOK()


print("CHANGE REFERENCE DATA - Key = 9E, Mechanism = 11 (ECC Point)")
res = sd.send(
		"00 24 " + // Change Ref Data
		"11 " +    // P256
		"9E " +    // Key ID 9E
		"45 " +    // APDU Len
		"30 43 " + // Sequence + :Len
		"86 " +    // EC Point
		"41 " +    // 65 Bytes
		"04 E2 DC 5D 77 4F 86 DB 42 04 36 1D 78 E6 E8 36 1C 3B BE 6E 1A 6E 8F 34 6C 3F 98 6B C1 5E 73 CE 9E 86 D4 C6 B9 81 6C BC B0 C6 A9 D7 6D C3 FF 33 C5 03 C5 0A 67 A4 E3 76 27 73 07 E0 67 D9 D0 21 23")
res.checkOK()


print("CHANGE REFERENCE DATA - Key = 9E, Mechanism = 11 (ECC Secret)")
res = sd.send(
		"00 24 " + // Change Ref Data
		"11 " +    // P256
		"9E " +    // Key ID 9E
		"24 " +    // APDU Len
		"30 22 " + // Sequence + :Len
		"87 " +    // EC Point
		"20 " +    // 32 Bytes
		"E3 59 58 DD 0C A2 11 24 4D 10 9C 89 7A 53 C6 73 FE 6F 4D 7E 4E F1 2A D1 4D 2F EE 6B 16 E1 2B 10")
res.checkOK()

/*
print("CHANGE REFERENCE DATA - PIN (80) to 123456")
res = sd.send("00 24 FF 80 08 31 32 33 34 35 36 FF FF")
res.checkOK()

print("CHANGE REFERENCE DATA - PUK (81) to 12345678")
res = sd.send("00 24 FF 81 08 31 32 33 34 35 36 37 38")
res.checkOK()

print("PUT DATA - 5FC105 - X.509 Certificate 9A (Part 1 of 5)")
res = sd.send("10 DB 3F FF EF 5C 03 5F C1 05 53 82 04 81 70 82 04 78 30 82 04 74 30 82 03 5C A0 03 02 01 02 02 09 00 F8 C1 FC 49 10 92 31 9D 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00 30 81 82 31 0B 30 09 06 03 55 04 06 13 02 41 55 31 0C 30 0A 06 03 55 04 08 13 03 4E 53 57 31 10 30 0E 06 03 55 04 07 13 07 45 78 61 6D 70 6C 65 31 18 30 16 06 03 55 04 0A 13 0F 45 78 61 6D 70 6C 65 20 50 74 79 20 4C 74 64 31 17 30 15 06 03 55 04 03 13 0E 45 78 61 6D 70 6C 65 20 39 41 20 4B 65 79 31 20 30 1E 06 09 2A 86 48 86 F7 0D 01 09 01 16 11 70 69 76 40 6D 61 6B 69 6E 61 2E 63 6F 6D 2E 61 75 30 1E 17 0D 31 37 31 30 31 37 30 31 35 31 31 38 5A 17 0D 32 32 31 30 31 36 30 31 35 31 31 38 5A 30 81 82 31 0B 30 09 06 03 55 04 06 13 02 41 55 31 0C 30 0A 06 03")
res.checkOK()

print("PUT DATA - 5FC105 - X.509 Certificate 9A (Part 2 of 5)")
res = sd.send("10 DB 3F FF EF 55 04 08 13 03 4E 53 57 31 10 30 0E 06 03 55 04 07 13 07 45 78 61 6D 70 6C 65 31 18 30 16 06 03 55 04 0A 13 0F 45 78 61 6D 70 6C 65 20 50 74 79 20 4C 74 64 31 17 30 15 06 03 55 04 03 13 0E 45 78 61 6D 70 6C 65 20 39 41 20 4B 65 79 31 20 30 1E 06 09 2A 86 48 86 F7 0D 01 09 01 16 11 70 69 76 40 6D 61 6B 69 6E 61 2E 63 6F 6D 2E 61 75 30 82 01 22 30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 82 01 0F 00 30 82 01 0A 02 82 01 01 00 A0 48 48 91 B9 5A 13 CB 95 1C 59 2B 68 93 A2 FD 98 8E 8E CB A6 FB E0 F0 1A EE 35 6D BC 8E E9 47 65 04 72 EA 9B 9E 88 EE 95 37 24 B0 E1 33 24 CC 46 0C F3 8F 47 6B AD C2 09 D4 00 8C 42 4D A9 D5 F0 27 02 1D 37 6E C3 5B 5F B7 6C F4 2C 88 CE BB DB 68 4D 97 0F 12 CC D6 48 D1 75 87 30 D9 3B")
res.checkOK()

print("PUT DATA - 5FC105 - X.509 Certificate 9A (Part 3 of 5)")
res = sd.send("10 DB 3F FF EF CF D8 79 52 63 5B 72 19 77 BB 5A F8 14 6F A5 68 27 30 FF 66 2A 83 2E B8 1B 2A F4 0C 17 EE 05 B6 91 99 C5 F3 EC C3 64 DE CB 5B 05 B1 03 9E 8F A4 E4 B2 E6 75 49 49 43 26 18 CC 70 20 34 AF 41 1D 80 D4 78 84 2D C9 ED 84 BE EE 65 8A D5 70 E0 60 39 B2 D3 5B BB 12 0F A2 CF B1 34 82 59 2A 18 1F 68 A1 D1 8C 81 50 1D DD 20 9D 20 17 61 6E A3 BD 8A 3E D3 7C 1C E4 8A 5A D5 E2 3E 0A 4D 79 3D 21 30 FB 02 CB E8 D9 98 EF BC 25 B6 12 63 D5 8F 44 FE EB C3 6A 33 6F 69 1F 6E FA BC 48 84 80 39 4C 59 02 03 01 00 01 A3 81 EA 30 81 E7 30 1D 06 03 55 1D 0E 04 16 04 14 A7 9C 4A B0 B2 72 BD 9D CD 98 C9 7D F6 D6 7C 65 D1 3A DB 1A 30 81 B7 06 03 55 1D 23 04 81 AF 30 81 AC 80 14 A7 9C 4A B0 B2 72 BD 9D CD 98 C9 7D F6 D6 7C 65 D1 3A DB 1A")
res.checkOK()

print("PUT DATA - 5FC105 - X.509 Certificate 9A (Part 4 of 5)")
res = sd.send("10 DB 3F FF EF A1 81 88 A4 81 85 30 81 82 31 0B 30 09 06 03 55 04 06 13 02 41 55 31 0C 30 0A 06 03 55 04 08 13 03 4E 53 57 31 10 30 0E 06 03 55 04 07 13 07 45 78 61 6D 70 6C 65 31 18 30 16 06 03 55 04 0A 13 0F 45 78 61 6D 70 6C 65 20 50 74 79 20 4C 74 64 31 17 30 15 06 03 55 04 03 13 0E 45 78 61 6D 70 6C 65 20 39 41 20 4B 65 79 31 20 30 1E 06 09 2A 86 48 86 F7 0D 01 09 01 16 11 70 69 76 40 6D 61 6B 69 6E 61 2E 63 6F 6D 2E 61 75 82 09 00 F8 C1 FC 49 10 92 31 9D 30 0C 06 03 55 1D 13 04 05 30 03 01 01 FF 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00 03 82 01 01 00 15 50 D6 15 91 E2 84 93 0E 4C 60 A4 96 3C 3C 04 C0 F1 83 C6 F8 16 C9 CE 34 94 C3 38 9D 16 80 A0 6E EE FD 34 E0 95 B7 7B 50 51 02 EF 97 34 8C A8 82 52 7F 0C 8B E8 D8")
res.checkOK()

print("PUT DATA - 5FC105 - X.509 Certificate 9A (Part 5 of 5)")
res = sd.send("00 DB 3F FF CE 4B 9B A2 48 4B E6 48 A3 0D 1A 26 EA 98 41 E1 22 FA 03 D0 67 2D 1E ED 7F 40 B9 56 B3 E3 43 7A FF 29 BA A8 0E D7 06 C3 82 A1 A3 07 78 06 DE D9 48 65 EE E6 E1 CB FE 59 6D DC BD EE B9 67 E0 E3 49 31 DF 80 B0 FD E8 F9 E0 A4 65 40 4A 51 01 C0 F4 81 DE 2C 59 FD BD 29 6C 76 62 0F 7F D7 89 5E A7 AE 39 27 44 79 7E 38 13 87 00 BC A4 72 19 69 A2 3A D3 36 AE 24 7F 90 70 68 27 9A D9 07 E2 2A CD A2 33 34 98 1A 5E 6A D6 D6 5C 43 97 B9 AB A9 8E 47 18 D8 78 72 E4 15 04 2F D5 51 96 06 3F D4 BA 52 A1 CC F5 35 44 8F 89 47 15 48 8C 79 67 0D 6B 50 96 6C A0 C5 1C 99 57 8E A4 AC E0 B1 5F E7 AB AD B1 11 14 3C F4 75 EF 5A 71 01 00 FE 00")
res.checkOK()


print("PUT DATA - 5FC101 - X.509 Certificate 9E (Part 1 of 5)")
res = sd.send("10 DB 3F FF EF 5C 03 5F C1 01 53 82 04 81 70 82 04 78 30 82 04 74 30 82 03 5C A0 03 02 01 02 02 09 00 ED F4 BA 46 C7 C9 D1 66 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00 30 81 82 31 0B 30 09 06 03 55 04 06 13 02 41 55 31 0C 30 0A 06 03 55 04 08 13 03 4E 53 57 31 10 30 0E 06 03 55 04 07 13 07 45 78 61 6D 70 6C 65 31 18 30 16 06 03 55 04 0A 13 0F 45 78 61 6D 70 6C 65 20 50 74 79 20 4C 74 64 31 17 30 15 06 03 55 04 03 13 0E 45 78 61 6D 70 6C 65 20 39 45 20 4B 65 79 31 20 30 1E 06 09 2A 86 48 86 F7 0D 01 09 01 16 11 70 69 76 40 6D 61 6B 69 6E 61 2E 63 6F 6D 2E 61 75 30 1E 17 0D 31 37 31 30 31 37 30 31 35 33 32 31 5A 17 0D 32 32 31 30 31 36 30 31 35 33 32 31 5A 30 81 82 31 0B 30 09 06 03 55 04 06 13 02 41 55 31 0C 30 0A 06 03")
res.checkOK()

print("PUT DATA - 5FC101 - X.509 Certificate 9E (Part 2 of 5)")
res = sd.send("10 DB 3F FF EF 55 04 08 13 03 4E 53 57 31 10 30 0E 06 03 55 04 07 13 07 45 78 61 6D 70 6C 65 31 18 30 16 06 03 55 04 0A 13 0F 45 78 61 6D 70 6C 65 20 50 74 79 20 4C 74 64 31 17 30 15 06 03 55 04 03 13 0E 45 78 61 6D 70 6C 65 20 39 45 20 4B 65 79 31 20 30 1E 06 09 2A 86 48 86 F7 0D 01 09 01 16 11 70 69 76 40 6D 61 6B 69 6E 61 2E 63 6F 6D 2E 61 75 30 82 01 22 30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 82 01 0F 00 30 82 01 0A 02 82 01 01 00 DA F6 1A 59 E2 D1 35 39 9A 42 38 7B 2E 45 AF 83 F6 21 2D 5B DE DA E4 62 BA AD A5 97 AC 78 03 8B DA 97 A7 51 36 C8 86 3F 18 8C F7 BC 27 2A B8 37 94 98 E1 3B D9 1A D1 44 7D 36 49 92 4E AB F8 D6 BC 03 36 CB EB 1E C7 51 B9 CE 35 C9 C3 C5 D2 55 75 D9 DC C5 8F 06 54 B1 84 CE AB E0 00 88 91")
res.checkOK()

print("PUT DATA - 5FC101 - X.509 Certificate 9E (Part 3 of 5)")
res = sd.send("10 DB 3F FF EF D0 DF FB C0 F3 B5 69 71 72 7A 4F A7 DF EA 83 37 15 FF 1B 9B 8F 45 A4 B9 E2 64 51 98 A9 46 0F 2D FF 74 01 A6 6E E3 3E 08 8A 45 86 82 F3 39 7E 7B C7 BD 2E 62 79 09 57 86 EA 4F BB 36 A0 A6 40 2C EF 95 F2 EA D9 05 06 16 8A FE 30 60 DB 36 9C 89 12 A8 4F 63 5C 59 EA 79 FA 68 6F 19 E0 D5 8B 97 37 99 0D 65 F1 A6 03 90 FF 47 CB 95 62 4E CE 0B 34 BF 09 C7 05 29 8E A1 6A E1 D6 E2 CA AB 2A 0F FB 14 98 2D 8F 8E 24 51 93 10 74 1A B3 6B 54 D3 90 C8 A1 58 F7 25 E8 6B 19 E1 0D 1A D8 8B F3 DC B5 02 03 01 00 01 A3 81 EA 30 81 E7 30 1D 06 03 55 1D 0E 04 16 04 14 CB 42 F8 48 3A CB CC C1 E5 5F 48 E0 B8 2F 4D 12 F8 D2 DA 70 30 81 B7 06 03 55 1D 23 04 81 AF 30 81 AC 80 14 CB 42 F8 48 3A CB CC C1 E5 5F 48 E0 B8 2F 4D 12 F8 D2 DA 70")
res.checkOK()

print("PUT DATA - 5FC101 - X.509 Certificate 9E (Part 4 of 5)")
res = sd.send("10DB3FFFEFA18188A48185308182310B3009060355040613024155310C300A060355040813034E53573110300E060355040713074578616D706C6531183016060355040A130F4578616D706C6520507479204C7464311730150603550403130E4578616D706C65203945204B65793120301E06092A864886F70D0109011611706976406D616B696E612E636F6D2E6175820900EDF4BA46C7C9D166300C0603551D13040530030101FF300D06092A864886F70D01010B05000382010100B97896B2243C13A1CF8035FF489C49601E09157370426A924B39C8D13B095EC9ED9C41100D2787B3E570E0BA491E5CD7F22B68888F4E9D")
res.checkOK()

print("PUT DATA - 5FC101 - X.509 Certificate 9E (Part 5 of 5)")
res = sd.send("00 DB 3F FF CE 6B 3F 89 A8 CD DE CD 82 B9 5D 80 45 31 10 6B 06 D9 83 2A 0A 61 85 A1 C6 33 63 15 83 38 68 78 2E C9 BC 1C 5F E0 57 4F 13 93 0C 6E 80 DA 1F 4B 2F 30 65 1E 7A 40 28 8A A4 D6 FA 84 3A 90 9E 9A B7 7C 0D 46 F6 D3 A0 EE 0F AE F1 6C E6 0E 1C 72 0C DF 77 CF EF A1 1E B6 E3 7D FC C9 3B 87 44 53 38 7C 80 FD 4A B0 53 B3 BC 9A 29 33 B6 35 7F BD 12 60 69 DA F6 9C 24 BF FA B1 07 1C AB 20 01 32 56 AF 25 28 65 06 4A D0 19 82 EB 45 F7 5D 89 93 9C AD 2A E6 59 CB 0E 8A 4F A5 D4 3D A4 37 34 10 F0 C2 27 3A B3 F0 D9 F7 D1 24 9A 6C 41 6A 8F CF 09 89 51 F0 E1 B3 DA CA 0C C5 FC BA A1 78 66 C9 2F 39 25 45 36 EA D0 4B 35 B7 71 01 00 FE 00")
res.checkOK()

print("PUT DATA - 5FC107 - Card Capability Container")

// Good Card Capability Container
res = sd.send("00DB3FFF 4B 5C03 5FC107 53 44 F015A00000007950495620322E332E3220636172642020F10121F20121F300F40111F50110F6110000000000000000000000000000000000F700FA00FB00FC00FD00FE00")

//res = sd.send("00DB3FFF 3A 5C03 5FC107 53 33 F015A000000116FF02E2C60C34BA90EF21F81F0E20D94CF10121F20121F300F40100F50110F600F700FA00FB00FC00FD00FE00")
res.checkOK()

print("PUT DATA - 5FC103 - Cardholder Fingerprints")
res = sd.send("00 DB 3F FF 88 5C 03 5F C1 03 53 81 80 BC 82 02 BE 03 0D 00 00 00 00 02 66 00 1B 02 01 00 00 00 00 00 00 00 5A 14 0B 0B 1D 05 25 1F 5A 14 0C 0B 1C 05 25 1F 5A 00 00 08 80 FE 4D 79 49 44 00 00 00 00 00 00 00 00 00 00 00 00 00 00 D4 E7 39 DA 73 9C ED 39 CE 73 9D A1 68 58 30 08 42 10 84 35 84 E7 39 C3 F6 00 00 00 00 30 82 02 62 06 09 2A 86 48 86 F7 0D 01 07 02 A0 82 02 53 30 82 02 4F 02 01 03 31 0B 30 09 06 05 2B 0E 03 02")
res.checkOK()


print("PUT DATA - 5FC106 - Security Object 1/5")
// len 239 = 0xEF (partial len = 230) total len = 230 + 239 + 239 + 46 = 778 = 0x030A
res = sd.send("10DB3FFF 17 5C03 5FC106 5382 030A " +
		"BA0C" +    // 0xBA DG to container mapping len 0x0C
		"013000" +  // CHUID
		"036030" +  // Card Holder Facial Image
		"026010" +  // Card Holder Fingerprints
		"043001")   // Printed Information
res.checkOK()

print("PUT DATA - 5FC106 - Security Object 2/5")
res = sd.send("10DB3FFF D8 BB 82 02F6" +  // 0xBB LDS Security Object
		"30 82 02F2 06092A864886F70D010702A08202E3" +
		"30 82 02DF 020103310F300D060960864801650304020105003081C106052B1B010101A081B70481B43081B1020100300D0609608648016503040201050030819C30250201010420D7CC59A21D290C9041EA0A81C973F42418BE791BCC7C7FB24507DEE37FD605CE30250201030420DA04ACEF17838452D358C5FBC0DE469CD0179056E5F107F18D3736612413405330250201020420C3BA8403C65AF9996499CC2328D74CFB0A3368EB648489A37A2C1A9D9A67434D30250201040420098B264E21")
res.checkOK()

print("PUT DATA - 5FC106 - Security Object 3/5")
// len 239 = 0xEF
res = sd.send("10DB3FFF EF 1E9141CDD3B57464999FC4DE678AA95E25B2444A29291D2516AE6D31820203" +
		"30 82 01FF 02010130733065310B300906035504061302555331183016060355040A130F552E532E20476F7665726E6D656E7431183016060355040B130F4943414D205465737420436172647331223020060355040313194943414D20546573742043617264205369676E696E67204341020A5853CCE2521801412008300D06096086480165030402010500A065301406092A864886F70D010903310706052B1B010101301C06092A864886F70D010905310F170D3138303532363139343834385A302F06092A864886F70D0109043122")
res.checkOK()

print("PUT DATA - 5FC106 - Security Object 4/5")
// len 239 = 0xEF
res = sd.send("10DB3FFF EF 0420B03403BD9BE3BC54C8A03CEED862745AE7800C17DB04B7454DC0B2DA7CD1A8BD300B06092A864886F70D01010104820100920531759DFE7515B425A22685780A50A4EDCF43A0DAB40A5F9FF939F05CEBD895D08101814F65913D1DF9E9383DE82F5EE114AB9B7500D5F7D27103C7F3418ABD9DBC727D012A54207158F907FB0266B7FA1451E836871C43985747F25665BFFD015B54E3C8D633094D878E8CB5056A7D88B0B268AF26962C9C45763E6E12EDA795A9A27C037A885556479FEE14F817870D38C94EA7D48CCFB6937C4A7B14CD230FEF865274F4F7FDE95BD6BF09749D3FD891C9D03ADE40000633EF")
res.checkOK()

print("PUT DATA - 5FC106 - Security Object 5/5")
// len 70 = 0x46
res = sd.send("00DB3FFF 46 20583481326223ABBE1F3F37335BB1D63E975E6247152FC6F5B27E1B72B2236A7AD8D01D4A03C858044AB4FF078DC608359A917A0DEE3787ED2E14B9E2E1E5750EFD8D23FE00")
res.checkOK()

print("PUT DATA - 5FC108 - Cardholder Facial Image")
res = sd.send("00 DB 3F FF 88 5C 03 5F C1 08 53 81 80 BC 82 02 BE 03 0D 00 00 00 00 02 66 00 1B 05 01 00 00 00 00 00 00 00 5A 14 0B 0B 1D 05 25 1F 5A 14 0C 0B 1C 05 25 1F 5A 00 00 02 20 FE 4D 79 49 44 00 00 00 00 00 00 00 00 00 00 00 00 00 00 D4 E7 39 DA 73 9C ED 39 CE 73 9D A1 68 58 30 08 42 10 84 35 84 E7 39 C3 F6 00 00 00 00 30 82 02 62 06 09 2A 86 48 86 F7 0D 01 07 02 A0 82 02 53 30 82 02 4F 02 01 03 31 0B 30 09 06 05 2B 0E 03 02")
res.checkOK()

//-----------BEGIN Write PrintedInformation APDUs ------------
print("Tag: 5FC109 part 1 Printed Information")
res = sd.send("00DB3FFF 4D 5C03 5FC109 53   46 010A426F62205061726B657202074E6F416666696C0408323033323035323605053132333435060A7465737449737375657207076F72674166663108076F726761666632FE00")
res.checkOK()
//-----------END Write PrintedInformation APDUs ------------

//-----------BEGIN Write CHUID APDUs ------------
print("Tag: 5FC102 CHUID part 1")
res = sd.send("10DB3FFF ED 5C03 5FC102 5382 0616 3019D4E739DA739CED39CE739DA1685821084210CD15CCE739B7E8320431323334341026E652A93723486F98163042AF121EC4350832303233303232363E8205BD308205B906092A864886F70D010702A08205AA308205A6020103310F300D06096086480165030402010500300A06086086480165030601A0820378308203743082031AA003020102020103300A06082A8648CE3D040302308188310B3009060355040613025553310B30090603550408130257413111300F060355040713084B69726B6C616E64310F300D060355040A1306476F6F676C65311A3018060355040B1311")
res.checkOK()
print("Tag: 5FC102 part 2")
res = sd.send("10DB3FFF ED 506879736963616C205365637572697479312C302A06035504031323476F6F676C6520546573742043617264205049562D49205369676E696E672043412031301E170D3137313230323030303030305A170D3332313233303233353935395A30818A310B3009060355040613025553310B30090603550408130257413111300F060355040713084B69726B6C616E64310F300D060355040A1306476F6F676C65311A3018060355040B1311506879736963616C205365637572697479312E302C06035504031325476F6F676C6520546573742043617264205049562D4920436F6E74656E74205369676E657230")
res.checkOK()
print("Tag: 5FC102 part 3")
res = sd.send("10DB3FFF ED 59301306072A8648CE3D020106082A8648CE3D0301070342000462D13D753B315EDB33EE3D4F3FED3A54661A8EB35F2E96DADA907D7635768FE3D2C0B6E0C629783B2ADEAE9F70E7E123A46367E2B84E4ACF94B59791206CA808A382016F3082016B301D0603551D0E041604144D9DFB4E5783B7AD3ECD0C417F33C1FAA363C43A301F0603551D23041830168014D066BACC7962B3A76B398141642620085F69D70C300E0603551D0F0101FF040403020780305B0603551D1F045430523050A04EA04C864A687474703A2F2F687474702E61706C2D746573742E636974652E66706B692D6C61622E676F762F63")
res.checkOK()
print("Tag: 5FC102 part 4")
res = sd.send("10DB3FFF ED 726C732F4943414D54657374436172645049562D495369676E696E6743412E63726C30180603551D200411300F300D060B608648016503020130817C3081A106082B06010505070101048194308191305606082B06010505073002864A687474703A2F2F687474702E61706C2D746573742E636974652E66706B692D6C61622E676F762F6169612F6365727473497373756564546F5049562D495369676E696E6743412E703763303706082B06010505073001862B687474703A2F2F6F6373702D706976692E61706C2D746573742E636974652E66706B692D6C61622E676F76300A06082A8648CE3D04030203")
res.checkOK()
print("Tag: 5FC102 part 5")
res = sd.send("10DB3FFF ED 480030450221009B443A39006E0ACD5D3C78D114BCD6F5A7C29823DDAF9B04CB43DE68B2AD9BE7022013F25D122A98575A50FA5E41854631F47465898DD830BCBF4331DB66E004A872318202063082020202010130818E308188310B3009060355040613025553310B30090603550408130257413111300F060355040713084B69726B6C616E64310F300D060355040A1306476F6F676C65311A3018060355040B1311506879736963616C205365637572697479312C302A06035504031323476F6F676C6520546573742043617264205049562D49205369676E696E672043412031020103300D060960864801")
res.checkOK()
print("Tag: 5FC102 part 6")
res = sd.send("10DB3FFF ED 65030402010500A0820105301706092A864886F70D010903310A06086086480165030601301C06092A864886F70D010905310F170D3230303630313230323932385A302F06092A864886F70D0109043122042060C0E3E1DC42C1F42543EBDDB00F19502FE6B80C5AD2D70FBFD32C7208AAAEF730819A0608608648016503060531818D30818A310B3009060355040613025553310B30090603550408130257413111300F060355040713084B69726B6C616E64310F300D060355040A1306476F6F676C65311A3018060355040B1311506879736963616C205365637572697479312E302C06035504031325476F")
res.checkOK()
print("Tag: 5FC102 part 7")
res = sd.send("00DB3FFF 91 6F676C6520546573742043617264205049562D4920436F6E74656E74205369676E6572300B06072A8648CE3D0201050004473045022100B6F76F25F615CD7413E1CF0E02E5A07A4ACEF8A26D0A670A09D40EC8A48C6720022033C7BB75309502488F344C8ABC627197CCC43D6F2140431073EDA971A21213A7EE02F9053610DB17539147494A32977D7A3843775E8AFE00")
res.checkOK()
//-----------END Write CHUID APDUs ------------
*/
print("Personalization complete")

